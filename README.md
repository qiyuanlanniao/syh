# 融合智能情境感知的海岛旅游订单系统

## 项目简介

本项目是一个基于Python Flask框架（后端）和微信小程序（前端）构建的融合智能情境感知的海岛旅游订单系统，专注于海岛旅游场景。系统旨在解决当前海岛旅游服务中信息获取滞后、个性化推荐不足以及服务流程繁琐等痛点，通过融合智能情境感知与初步的互动式推荐算法，为用户提供便捷、智能的旅游产品预订和信息服务。

## 技术栈

*   **后端 (Backend):**
    *   编程语言: Python 3.x
    *   Web框架: Flask
    *   ORM: SQLAlchemy
    *   数据库: MySQL
    *   API标准: RESTful API
    *   安全: Bcrypt (密码哈希), Flask Interceptor (身份认证)
    *   异步任务: (通过QueueService提及，具体实现如Celery/Redis等可补充)
    *   其他: Jinja2 (后台模板引擎), JSON
*   **前端 - 微信小程序 (Frontend - WeChat Mini Program):**
    *   开发语言: JavaScript (ES6+), WXML, WXSS
    *   核心API: 微信登录 (`wx.login`), 微信支付 (`wx.requestPayment`), 地理位置, 分享等
    *   UI组件: 微信原生组件, WxParse (富文本解析)
    *   状态管理: Page data, App globalData, `wx.setStorageSync` (本地缓存)
*   **前端 - 后台管理界面 (Frontend - Admin Panel):**
    *   HTML, CSS, JavaScript
    *   JavaScript库: jQuery, Highcharts (数据可视化)
*   **开发与辅助工具:**
    *   IDE: PyCharm, 微信开发者工具
    *   数据库管理: SQLyog
    *   版本控制: Git, GitHub
    *   内网穿透: ngrok (用于微信支付本地回调测试)

## 系统功能

### 微信小程序端 (游客)

1.  **用户模块:**
    *   微信授权快速登录/注册
    *   个人中心: 查看订单、管理收货地址、查看评价
2.  **商品模块:**
    *   首页展示: 轮播图、商品分类导航
    *   商品列表: 分类浏览、关键词搜索、上拉加载分页
    *   商品详情: 图文展示、轮播图、富文本描述、分享功能
3.  **购物车模块:**
    *   添加商品至购物车
    *   查看购物车列表、修改商品数量、删除商品
    *   商品选中/全选、实时计算总价
4.  **订单模块:**
    *   订单确认页: 展示商品、选择收货地址、查看运费和总价
    *   创建订单、提交订单
    *   微信支付: 拉起微信支付界面完成支付
    *   订单列表: 查看不同状态的订单（待付款、待发货等）
    *   订单详情: 查看订单详细信息
    *   订单操作: 取消订单、确认收货、评价订单
5.  **收货地址模块:**
    *   新增、编辑、删除收货地址
    *   设置默认收货地址
    *   列表展示所有收货地址
6.  **互动客服/推荐模块:**
    *   展示实时天气信息及基于天气的饮品推荐
    *   引导用户输入偏好标签
    *   基于用户标签和MAB模型进行商品推荐
    *   用户可将推荐商品加入“心仪列表”（本地）并进行管理

### 后台管理系统 (管理员)

1.  **登录与账户管理:**
    *   管理员安全登录、退出
    *   管理员账户的增、删、改、查、状态管理
2.  **商品管理:**
    *   商品分类的增、删、改、查、状态管理
    *   商品的增、删、改、查、上下架、库存管理
    *   富文本编辑器 (UEditor) 集成，无刷新图片上传
3.  **会员管理:**
    *   查看会员列表、搜索、分页
    *   会员状态管理（禁用/恢复）
    *   (预留) 查看会员详情、评论管理
4.  **订单管理:**
    *   查看订单列表、按状态筛选、搜索、分页
    *   查看订单详情
    *   操作：标记发货
5.  **财务管理:**
    *   财务流水展示
    *   总收款金额统计
6.  **统计管理:**
    *   多维度数据统计: 日营收、商品销量、会员消费、分享次数
    *   支持按日期范围查询
    *   数据可视化: 使用 Highcharts 展示图表 (如营收趋势)
    *   仪表盘: 核心运营指标总览
7.  **系统管理:**
    *   访问日志、错误日志查看 (通过LogService记录)
    *   轮播图等平台内容管理

## 核心技术点与解决方案

1.  **并发库存扣减 (超卖问题):** 后端采用数据库事务结合**行级悲观锁 (SQLAlchemy `with_for_update()`)** 机制，确保在高并发场景下库存扣减的原子性和准确性。
2.  **订单创建原子性:** 订单创建涉及的多表操作（主订单、订单项、库存更新、购物车清理）被封装在数据库事务中，保证操作的整体一致性。
3.  **微信支付集成与异步回调:** 安全对接微信支付统一下单接口，并在小程序端拉起支付。后端设计了安全的回调接口，进行严格的签名验证、订单金额核对，并利用**消息队列 (QueueService)** 异步处理支付成功后的耗时任务（如发送通知）。
4.  **统计数据高效查询:** 采用**每日预计算统计表**的策略，将复杂的聚合查询离线化，前端查询时直接访问预处理结果，提升统计报表加载速度。
5.  **身份认证与访问控制:** 后台管理系统和微信小程序API均设计了**登录拦截器**，基于安全的令牌/Cookie机制进行用户/会员身份认证和权限校验。
6.  **本地化互动推荐算法:** 在微信小程序端探索实现了基于用户偏好标签输入和**Multi-Armed Bandit (MAB)模型 (Epsilon-Greedy策略)** 的商品推荐，并结合实时天气信息进行情境辅助，模型参数本地存储与在线更新。
